---
title: "Project 6"
author: "Juliette Dashe"
date: "2025-11-15"
output: html_document
---
```{r}


student_depression_dataset$id <- NULL
student_depression_dataset$`Work Pressure` <- NULL
student_depression_dataset$`Job Satisfaction` <- NULL
student_depression_dataset$Profession <- NULL

table(student_depression_dataset$Degree)


names(student_depression_dataset)
```



```{r}

#Juliette's code
print(">>>")
```

```{r}
#Tanner's code

library(readr)
library(dplyr)

df <- read_csv("student_depression_dataset.csv")

df$id <- NULL
df$Profession <- NULL
df$'Work Pressure' <- NULL
df$'Job Satisfaction' <- NULL

df$Depression <- as.factor(df$Depression)

df$Gender <- as.factor(df$Gender)
df$City <- as.factor(df$City)
df$'Sleep Duration' <- as.factor(df$'Sleep Duration')
df$'Dietary Habits' <- as.factor(df$'Dietary Habits')
df$Degree <- as.factor(df$Degree)
df$'Have you ever had suicidal thoughts ?' <- as.factor(df$'Have you ever had suicidal thoughts ?')
df$'Family History of Mental Illness' <- as.factor(df$'Family History of Mental Illness')
```
```{r}
library(tidymodels)

set.seed(445)
index <- sample(1:nrow(df), size = 0.8 * nrow(df))

train <- df[index, ]
test <- df[-index, ]
```
```{r}
knn_recipe <- recipe(Depression ~ ., data = train) %>%
  step_dummy(all_nominal_predictors()) %>%
  step_zv(all_predictors()) %>%
  step_normalize(all_predictors())
```
```{r}
prep_recipe <- prep(knn_recipe)

train_processed <- bake(prep_recipe, new_data = train)
test_processed <- bake(prep_recipe, new_data = test)
```
```{r}
knn_model <- nearest_neighbor(
  neighbors = 5, 
  weight_func = "rectangular"
) %>% 
  set_engine("kknn") %>%
  set_mode("classification")
```
```{r}
knn_fit <- fit(knn_model, Depression ~ ., data = train_processed)
```



```{r}

#Munisa's code
```

```{r}
#Leah's code

#Importing Dataset
library(readr)
student_depression_dataset <- read_csv("student_depression_dataset.csv")

#Data Cleaning
student_depression_dataset$id <- NULL
student_depression_dataset$`Work Pressure` <- NULL
student_depression_dataset$`Job Satisfaction` <- NULL
student_depression_dataset$Profession <- NULL

#Juliette's Data Cleaning with Degree Currently Pursuing
library(dplyr)

df_clean <- student_depression_dataset |>
  mutate(
    # Making degrees into 5 categories 
    Academic_Level = case_when(
      # High School
      Degree == "'Class 12'" ~ "High School",
      
      # Bachelor's Degrees (including B.Pharm, B.Tech, MBBS, etc.)
      Degree %in% c("BE", "B.Arch", "BHM", "B.Com", "BSc", "B.Ed", "LLB", 
                    "B.Pharm", "B.Tech", "BA", "BBA", "BCA") ~ "Bachelor's",
      
      # Master's Degrees/Professional Doctorates
      Degree %in% c("MA", "MBA", "MBBS", "MCA", "LLM", "MD", "M.Com", 
                    "ME", "M.Ed", "MHM", "M.Pharm", "MSc", "M.Tech", "MBBS") ~ "Master's",
      
      # PhD
      Degree == "PhD" ~ "PhD",
      
      # Other/Unspecified
      Degree == "Others" ~ "Other",
      
      # Catch-whatever else I might be missing 
      TRUE ~ "Unknown"
    ),
    
    # Convert the new column to an ordered factor for consistent analysis
    Academic_Level = factor(Academic_Level, 
                            levels = c("High School", "Bachelor's", "Master's", "PhD", "Other", "Unknown"))
  )

cat("Frequency of new Academic Levels:\n")
df_clean |>
  count(Academic_Level) |>
  print()
```

```{r}
#Leah's code 2

#Plotting (not all useful but I tried all combos)
head(df_clean)

library(ggplot2)

#Scatterplots - dbl vs dbl values
#Age vs other predictors
ggplot(data = df_clean, aes(x = `Age`, y = `Academic Pressure`)) + geom_point()
ggplot(data = df_clean, aes(x = `Age`, y = `CGPA`)) + geom_point()
ggplot(data = df_clean, aes(x = `Age`, y = `Study Satisfaction`)) + geom_point()
ggplot(data = df_clean, aes(x = `Age`, y = `Work/Study Hours`)) + geom_point()
ggplot(data = df_clean, aes(x = `Age`, y = `Financial Stress`)) + geom_point()

#Academic Pressure vs other predictors
ggplot(data = df_clean, aes(x = `Academic Pressure`, y = `CGPA`)) + geom_point()
ggplot(data = df_clean, aes(x = `Academic Pressure`, y = `Study Satisfaction`)) + geom_point()
ggplot(data = df_clean, aes(x = `Academic Pressure`, y = `Work/Study Hours`)) + geom_point()
ggplot(data = df_clean, aes(x = `Academic Pressure`, y = `Financial Stress`)) + geom_point()

#CGPA vs other predictors
ggplot(data = df_clean, aes(x = `CGPA`, y = `Study Satisfaction`)) + geom_point()
ggplot(data = df_clean, aes(x = `CGPA`, y = `Work/Study Hours`)) + geom_point()
ggplot(data = df_clean, aes(x = `CGPA`, y = `Financial Stress`)) + geom_point()

#Study Satisfaction vs other predictors
ggplot(data = df_clean, aes(x = `Study Satisfaction`, y = `Work/Study Hours`)) + geom_point()
ggplot(data = df_clean, aes(x = `Study Satisfaction`, y = `Financial Stress`)) + geom_point()

#Work/Study Hours vs other predictors
ggplot(data = df_clean, aes(x = `Work/Study Hours`, y = `Financial Stress`)) + geom_point()
```
```{r}
#Leah's code 3

#Plotting
head(df_clean)

#Bar plots - chrs
ggplot(data = df_clean, aes(x = `Gender`)) + geom_bar()
ggplot(data = df_clean, aes(x = `City`)) + geom_bar()
ggplot(data = df_clean, aes(x = `Sleep Duration`)) + geom_bar()
ggplot(data = df_clean, aes(x = `Dietary Habits`)) + geom_bar()
ggplot(data = df_clean, aes(x = `Have you ever had suicidal thoughts ?`)) + geom_bar()
ggplot(data = df_clean, aes(x = `Academic_Level`)) + geom_bar()
```

